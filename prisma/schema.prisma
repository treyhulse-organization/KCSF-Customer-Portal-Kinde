// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

// Looking for ways to speed up your queries, or scale easily with your serverless or edge functions?
// Try Prisma Accelerate: https://pris.ly/cli/accelerate-init

// Commands to run: npx prisma generate  |  npx prisma migrate dev --name add_customers_and_addresses  |  npx prisma migrate deploy



generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider  = "postgresql"
  url       = env("DATABASE_URL")
  directUrl = env("DIRECT_URL")
}        

model User {
  id           String  @id @unique
  email        String
  firstName    String
  lastName     String
  profileImage String
  customerId   String? @unique

  createdAt DateTime @default(now())

  Subscription Subscription?
}

model Subscription {
  stripeSubscriptionId String   @id @unique
  interval             String
  status               String
  planId               String
  currentPeriodStart   Int
  currentPeriodEnd     Int
  createdAt            DateTime @default(now())
  updatedAt            DateTime @updatedAt

  User   User?   @relation(fields: [userId], references: [id])
  userId String? @unique
}





// HERE IS WHERE I START TO BRANCH OFF

model Items {
  id                String   @id @default(uuid())
  org_id            String
  name              String
  description       String?
  sku               String
  type              String
  variations        Json?
  global_identifier String?
  status            ItemStatus @default(DRAFT)
  metadata          Json?
  notes             String?
  unit_of_measure   String
  weight            Decimal?
  weight_unit       WeightUnit?
  length            Decimal?
  length_unit       DimensionUnit?
  width             Decimal?
  width_unit        DimensionUnit?
  depth             Decimal?
  depth_unit        DimensionUnit?
  tags              Json?
  createdAt         DateTime @default(now())
  updatedAt         DateTime @updatedAt

  @@unique([org_id, sku])
}

enum ItemStatus {
  ACTIVE
  DRAFT
  ARCHIVED
}

enum WeightUnit {
  OUNCE
  POUND
}

enum DimensionUnit {
  INCH
  CENTIMETER
  FOOT
}

model Customers {
  id                      String    @id @default(uuid())
  customer_id             String
  org_id                 String
  first_name             String?
  last_name              String?
  company_name           String?
  email                  String
  alt_email              String?
  phone                  String?
  alt_phone              String?
  account_rep            String?
  comments               String?
  last_order_date        DateTime?
  customer_category      String?
  notes                  String?   @db.Text
  default_shipping_address String?
  default_billing_address  String?
  created_at             DateTime  @default(now())
  updated_at             DateTime  @updatedAt

  // Relations
  addresses              Addresses[]
  shipping_address       Addresses? @relation("ShippingAddress", fields: [default_shipping_address], references: [address_id])
  billing_address        Addresses? @relation("BillingAddress", fields: [default_billing_address], references: [address_id])

  @@unique([org_id, customer_id])
}

model Addresses {
  id            String    @id @default(uuid())
  address_id    String    @unique @default(uuid())
  org_id        String
  customer_id   String
  easypost_id   String?
  name          String?
  company       String?
  street1       String
  street2       String?
  city          String
  state         String
  country       String
  zip           String
  verified      Boolean   @default(false)
  latitude      Float?
  longitude     Float?
  created_at    DateTime  @default(now())
  updated_at    DateTime  @updatedAt

  // Relations
  customer      Customers @relation(fields: [customer_id], references: [id])
  shipping_for  Customers[] @relation("ShippingAddress")
  billing_for   Customers[] @relation("BillingAddress")

  @@unique([org_id, address_id])
}
